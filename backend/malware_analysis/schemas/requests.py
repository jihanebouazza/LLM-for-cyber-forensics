from pydantic import BaseModel
from typing import Optional, List, Dict, Any


class StaticReport(BaseModel):
    file_type: Optional[str] = None
    detected_family: Optional[str] = None
    suspicious_strings: Optional[List[str]] = None


class BehaviorEvent(BaseModel):
    action: str              # e.g. "create_file", "modify_registry"
    target: Optional[str]    # file path, registry key, etc.
    extra: Dict[str, Any] = {}


class DynamicReport(BaseModel):
    behaviors: List[BehaviorEvent] = []


class MalwareAnalyzeRequest(BaseModel):
    filename: str
    hash: Optional[str] = None
    static: Optional[StaticReport] = None
    dynamic: Optional[DynamicReport] = None
