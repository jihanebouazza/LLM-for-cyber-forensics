from fastapi import FastAPI, Depends, HTTPException
from pydantic import BaseModel
from typing import List, Annotated
from .database import engine, SessionLocal, Base
from sqlalchemy.orm import Session
from .models import *
from .routes import samples_router, analysis_router, iocs_router, capabilities_router, configs_router, recommendations_router, detection_hints_router, analyses_router, clusters_router, campaigns_router, samples_campaign_router, reports_router
import logging

logging.basicConfig(
    level=logging.INFO,
    format="%(asctime)s | %(levelname)s | %(name)s | %(message)s",
)

# Base.metadata.create_all(bind=engine)


app = FastAPI()

app.include_router(samples_router, prefix="/malwares", tags=["malwares"])
app.include_router(analysis_router, prefix="/malwares", tags=["malwares"])
app.include_router(iocs_router, prefix="/malwares", tags=["malwares"])
app.include_router(capabilities_router, prefix="/malwares", tags=["malwares"])
app.include_router(configs_router, prefix="/malwares", tags=["malwares"])
app.include_router(recommendations_router,
                   prefix="/malwares", tags=["malwares"])
app.include_router(detection_hints_router,
                   prefix="/malwares", tags=["malwares"])
app.include_router(analyses_router, prefix="/malwares", tags=["malwares"])
app.include_router(clusters_router, prefix="/malwares", tags=["malwares"])
app.include_router(campaigns_router, prefix="/malwares", tags=["malwares"])
app.include_router(samples_campaign_router,
                   prefix="/malwares", tags=["malwares"])
app.include_router(reports_router,
                   prefix="/malwares", tags=["malwares"])
