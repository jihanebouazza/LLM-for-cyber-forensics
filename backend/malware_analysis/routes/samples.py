from uuid import UUID
from fastapi import APIRouter, Depends, HTTPException
from sqlalchemy.orm import Session

from ..database import get_db
from ..models.malware_samples import MalwareSample
from ..schemas.malware_samples import MalwareSampleOut

router = APIRouter()


@router.get("/", response_model=list[MalwareSampleOut])
def list_samples(db: Session = Depends(get_db)):
    samples = db.query(MalwareSample).all()
    return samples


@router.get("/{sample_id:uuid}", response_model=MalwareSampleOut)
def get_sample(sample_id: UUID, db: Session = Depends(get_db)):
    sample = db.query(MalwareSample).get(sample_id)
    if not sample:
        raise HTTPException(status_code=404, detail="Sample not found")
    return sample
