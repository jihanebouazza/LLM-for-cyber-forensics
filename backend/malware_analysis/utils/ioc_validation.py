import re

PLACEHOLDER_VALUES = {"1.2.3.4", "example.com", "localhost", "...", "null", "8.8.8.8"}


def is_placeholder(value: str) -> bool:
    v = (value or "").strip().lower()
    return v in PLACEHOLDER_VALUES or v == ""


def valid_ip(v: str) -> bool:
    return bool(re.fullmatch(r"(?:\d{1,3}\.){3}\d{1,3}", v))


def valid_domain(v: str) -> bool:
    # simple, but works ok for IOC filtering
    return bool(re.fullmatch(r"[a-z0-9.-]+\.[a-z]{2,}", v.lower()))


def valid_hash(v: str) -> bool:
    vv = v.lower()
    if vv.startswith("sha256:"):
        vv = vv.split("sha256:", 1)[1]
    return bool(re.fullmatch(r"[a-f0-9]{64}", vv))


TYPE_WORDS = {
    "url", "domain", "ip", "hash", "file_path", "registry_key", "mutex",
    "email", "process", "service", "user_agent"
}


def looks_like_type_word(v: str) -> bool:
    s = (v or "").strip().lower()
    return s in TYPE_WORDS


def split_multi_values(v: str) -> list[str]:
    # handles "23.1.1.1, 23.1.1.2"
    parts = [p.strip() for p in re.split(r"[,\s]+", v) if p.strip()]
    return parts
